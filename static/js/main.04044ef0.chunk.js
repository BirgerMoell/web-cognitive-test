(this["webpackJsonpweb-cognitive-test"]=this["webpackJsonpweb-cognitive-test"]||[]).push([[0],{37:function(e,t,n){},54:function(e,t,n){},61:function(e,t,n){"use strict";n.r(t);var o=n(1),i=n(0),r=n.n(i),a=n(10),c=n.n(a),s=(n(54),n.p+"static/media/kthlogo.b07cd2db.png"),l=(n(37),n(4)),d=n(80),u=n(84);function j(){return{top:"".concat(50,"%"),left:"".concat(50,"%"),transform:"translate(-".concat(50,"%, -").concat(50,"%)")}}var h=Object(d.a)((function(e){return{paper:{position:"absolute",width:600,backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)}}}));function p(e){var t=h(),n=r.a.useState(j),i=Object(l.a)(n,1)[0],a=Object(o.jsxs)("div",{style:i,className:t.paper,children:[Object(o.jsx)("h2",{id:"simple-modal-title",children:"Forskningsprojekt om r\xf6st och kognition"}),Object(o.jsx)("p",{id:"simple-modal-description",children:"Studien bedrivs vid Tal Musik H\xf6rsel p\xe5 KTH med m\xe5ls\xe4ttning att f\xf6rb\xe4ttra diagnostik vid Alzheimer."}),Object(o.jsx)("p",{id:"simple-modal-description",children:"Studien riktar sig fr\xe4mst till dig som har f\xe5tt en diagnos relaterad till kognitiv neds\xe4ttning som MCI eller Alzheimers sjukdom."}),Object(o.jsx)("p",{id:"simple-modal-description",children:"Genom att vara med i studien godk\xe4nner du att din r\xf6st sparas och lagras p\xe5 servrar tillh\xf6rande Kungliga Tekniska H\xf6gskolans enhet f\xf6r Tal Musik H\xf6rsel."}),Object(o.jsx)("p",{id:"simple-modal-description",children:"Ansvarig forskare f\xf6r studien \xe4r Professor Jonas Beskow (beskow@kth.se) och Birger Mo\xebll (bmoell@kth.se)."}),Object(o.jsx)("button",{type:"button",onClick:e.handleClose,children:"Jag godk\xe4nner att min r\xf6st anv\xe4nds i en forskningsstudie"}),Object(o.jsx)("button",{type:"button",onClick:e.handleOpen,children:"Jag vill inte medverka i studien."}),Object(o.jsx)(p,{})]});return Object(o.jsx)("div",{children:Object(o.jsx)(u.a,{open:e.open,onClose:e.handleClose,"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description",children:a})})}var b,g=n(44),v=n(5),f=n(8),x=n.n(f),m=n(17),O="http://127.0.0.1:8000";document.createElement("audio").controls=!0;var k=function(){var e=r.a.useState(!1),t=Object(l.a)(e,2),n=(t[0],t[1],[]),i=function(){var e=Object(m.a)(x.a.mark((function e(){var t,n,o;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={diagnosis:0,cognition:2,timeStamp:new Date},e.next=3,fetch(O+"/upload_answer/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 3:return n=e.sent,console.log("the response is",n),e.next=7,n.json();case 7:o=e.sent,console.log("the response json is",o);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),a=function(){var e=Object(m.a)(x.a.mark((function e(){var t,o,i,r;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s();case 2:return console.log("the chunks are ",n),t=new Blob(n,{type:"audio/webm;codecs=opus"}),console.log("the blob is",t),(o=new FormData).append("file",t,"file"),console.log("the form is",o),e.next=10,fetch(O+"/upload_audio/",{method:"POST",body:o});case 10:return i=e.sent,console.log("the response is",i),e.next=14,i.json();case 14:r=e.sent,console.log("the response audio is",r);case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),c=function(){var e=Object(m.a)(x.a.mark((function e(){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("we are recording"),e.next=3,navigator.mediaDevices.getUserMedia({audio:!0,video:!1});case 3:t=e.sent,(b=new MediaRecorder(t)).start(500),b.ondataavailable=function(e){console.log("the mediarecorder data is ",e.data);var t=e.data;n.push(t)};case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),s=function(){var e=Object(m.a)(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:b.stop();case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(o.jsxs)("div",{children:[Object(o.jsx)("div",{onClick:function(){return i()},children:"This is the admin page"}),Object(o.jsx)("button",{onClick:function(){return c()},children:"Start recording"}),Object(o.jsx)("button",{onClick:function(){return a()},children:"Send audio to server"})]})},y=n(38),w=n(31),S=n.p+"static/media/cube.adc57f1d.png",T=n(83),E=Object(d.a)((function(e){return{root:{"& > *":{margin:e.spacing(1)}}}}));function C(e){var t=E();return Object(o.jsx)("div",{className:t.root,children:Object(o.jsx)(T.a,{onClick:e.onClick,variant:"contained",color:"primary",children:e.text})})}var P="http://127.0.0.1:8000";function M(e){var t=r.a.useState(""),n=Object(l.a)(t,2),a=n[0],c=n[1],d=r.a.useState(""),u=Object(l.a)(d,2),j=u[0],h=u[1],p=r.a.useState(!1),b=Object(l.a)(p,2),g=b[0],v=b[1],f=(Object(i.useRef)(null),function(){var e=Object(m.a)(x.a.mark((function e(){var t,n,o;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={diagnosis:a,cognition:j,timeStamp:new Date},e.next=3,fetch(P+"/upload_answer/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 3:return n=e.sent,console.log("the response is",n),e.next=7,n.json();case 7:o=e.sent,console.log("the response json is",o);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}());return g?Object(o.jsxs)("div",{className:"AudioForm-container",children:[Object(o.jsx)("p",{children:"Tack f\xf6r att du var med i v\xe5r unders\xf6kning. Tipsa g\xe4rna flera att vara med i v\xe5r studie."}),Object(o.jsx)("img",{src:s,width:"150px",alt:"logo"}),Object(o.jsx)("p",{children:"H\xf6r av dig till bmoell@kth.se om du har n\xe5gra fr\xe5gor kring studien."})]}):Object(o.jsxs)("div",{className:"AudioForm-container",children:[Object(o.jsx)("label",{for:"diagnos",children:"Har du en diagnos av en kognitiv neds\xe4ttning"}),Object(o.jsx)("br",{}),Object(o.jsxs)("select",{onChange:function(e){return c(e.target.value)},name:"diagnos",id:"diagnos",children:[Object(o.jsx)("option",{value:0,children:"Ingen diagnos"}),Object(o.jsx)("option",{value:1,children:"MCI"}),Object(o.jsx)("option",{value:2,children:"Alzheimer"})]}),Object(o.jsx)("hr",{}),Object(o.jsx)("label",{for:"cognition",children:"Anser du sj\xe4lv att du har kognitiva sv\xe5righeter"}),Object(o.jsxs)("select",{onChange:function(e){return h(e.target.value)},name:"diagnos",id:"diagnos",children:[Object(o.jsx)("option",{value:0,children:"Inga kognitiva sv\xe5righeter"}),Object(o.jsx)("option",{value:1,children:"Vissa kognitiva sv\xe5righerer"}),Object(o.jsx)("option",{value:2,children:"Allvarliga kognitiva sv\xe5righeter"}),Object(o.jsx)("option",{value:3,children:"Mycket Allvarliga kognitiva sv\xe5righeter"})]}),Object(o.jsx)("hr",{}),Object(o.jsx)("label",{for:"cognition",children:"Vad \xe4r ditt k\xf6n"}),Object(o.jsxs)("select",{onChange:function(e){return h(e.target.value)},name:"diagnos",id:"diagnos",children:[Object(o.jsx)("option",{value:0,children:"Man"}),Object(o.jsx)("option",{value:1,children:"Kvinna"}),Object(o.jsx)("option",{value:2,children:"Icke-Bin\xe4r"})]}),Object(o.jsx)("hr",{}),Object(o.jsx)("label",{for:"cognition",children:"Vad \xe4r din \xe5lder"}),Object(o.jsx)("input",{}),Object(o.jsx)("hr",{}),Object(o.jsx)("label",{for:"cognition",children:"Vad \xe4r din utbildning-niv\xe5"}),Object(o.jsxs)("select",{onChange:function(e){return h(e.target.value)},name:"diagnos",id:"diagnos",children:[Object(o.jsx)("option",{value:0,children:"Upp till 9 \xe5r (mindre \xe4n grundskola, \xe5rskurs 9)"}),Object(o.jsx)("option",{value:1,children:"Upp till 12 \xe5r (mindre \xe4n gymnasium, \xe5rskurs 12)"}),Object(o.jsx)("option",{value:2,children:"Efergymnasial utbildning, mindre \xe4n 3 \xe5r"}),Object(o.jsx)("option",{value:2,children:"Efergymnasial utbildning, l\xe4ngre \xe4n 3 \xe5r"})]}),Object(o.jsx)("hr",{}),Object(o.jsx)(C,{onClick:function(){return v(!0),console.log("the recorded file is",e.recorded),void f()},text:"Skicka in dina svar"})]})}var I=function(e){var t=Object(i.useState)(!1),n=Object(l.a)(t,2),r=n[0],a=n[1];function c(e,t){"down"==e&&(j=h,p=b,h=t.clientX-s.offsetLeft,b=t.clientY-s.offsetTop,u=!0,!0&&(d.beginPath(),d.fillStyle=g,d.fillRect(h,b,2,2),d.closePath(),!1)),"up"!=e&&"out"!=e||(u=!1),"move"==e&&u&&(j=h,p=b,h=t.clientX-s.offsetLeft,b=t.clientY-s.offsetTop,d.beginPath(),d.moveTo(j,p),d.lineTo(h,b),d.strokeStyle=g,d.lineWidth=v,d.stroke(),d.closePath())}Object(i.useEffect)((function(){!function(){s=document.getElementById("cube"),d=s.getContext("2d");s.width,s.height;s.addEventListener("mousemove",(function(e){c("move",e)}),!1),s.addEventListener("mousedown",(function(e){c("down",e)}),!1),s.addEventListener("mouseup",(function(e){c("up",e)}),!1),s.addEventListener("mouseout",(function(e){c("out",e)}),!1)}()}),[]);var s,d,u=!1,j=0,h=0,p=0,b=0,g="black",v=2;return r?Object(o.jsx)(M,{recorded:e.recorded}):Object(o.jsxs)("div",{children:[Object(o.jsx)("img",{style:{padding:"25px"},width:"600",height:"600",src:S}),Object(o.jsx)("canvas",{id:"cube",width:"600",height:"600"}),Object(o.jsxs)("div",{style:{display:"flex","align-items":"center","justify-content":"center","flex-direction":"column"},children:[Object(o.jsx)("p",{style:{"text-align":"center"},children:"Rita en kub lik den som du ser p\xe5 v\xe4nster sida"}),Object(o.jsx)("button",{onClick:function(){return a(!0),void console.log("we are moving on")},children:"G\xe5 vidare"})]})]})};function A(){var e=Object(y.a)(["\n  border-radius: 100px;\n  background-color: lightgrey;\n  border: 1px solid black;\n  height: 50px;\n  width: 50px;\n  position: relative;\n  top: ","px;\n  left: ","px;\n"]);return A=function(){return e},e}w.a.div(A(),(function(e){return e.top}),(function(e){return e.left}));var D=[{value:"1",x:100,y:50},{value:"A",x:300,y:100},{value:"2",x:100,y:250},{value:"B",x:400,y:275},{value:"3",x:300,y:300},{value:"C",x:250,y:400},{value:"4",x:400,y:400},{value:"D",x:500,y:500},{value:"5",x:500,y:250},{value:"E",x:600,y:400},{value:"6",x:400,y:800},{value:"F",x:700,y:600},{value:"7",x:650,y:700},{value:"G",x:800,y:800}],L=function(e){var t=[],n=Object(i.useState)(!1),r=Object(l.a)(n,2),a=r[0],c=r[1];function s(e,n){"down"==e&&(h=p,b=g,p=n.clientX-d.offsetLeft,g=n.clientY-d.offsetTop,j=!0,!0&&(u.beginPath(),u.fillStyle=v,u.fillRect(p,g,2,2),u.closePath(),!1)),"up"!=e&&"out"!=e||(j=!1),"move"==e&&j&&(h=p,b=g,p=n.clientX-d.offsetLeft,g=n.clientY-d.offsetTop,u.beginPath(),u.moveTo(h,b),u.lineTo(p,g),u.strokeStyle=v,u.lineWidth=f,u.stroke(),u.closePath()),function(e,n){console.log("inside collection detection with ",e),Object.values(D).map((function(o,i){return o.x>e-50&&o.x<e+50&&o.y>n-50&&o.y<n+50?-1===t.indexOf(o.value)?t.push(o.value):console.log("This item already exists"):null})),console.log("the mouse movement is",t),t.length===D.length&&(console.log("we completed the task"),c(!0))}(p,g)}Object(i.useEffect)((function(){!function(){d=a?document.getElementById("cube"):document.getElementById("can"),u=d.getContext("2d");d.width,d.height;d.addEventListener("mousemove",(function(e){s("move",e)}),!1),d.addEventListener("mousedown",(function(e){s("down",e)}),!1),d.addEventListener("mouseup",(function(e){s("up",e)}),!1),d.addEventListener("mouseout",(function(e){s("out",e)}),!1);var e=Object.values(D);a||e.map((function(e,t){return console.log("the item is",e),function(e,t,n,o){e.beginPath(),e.arc(n,o,50,0,2*Math.PI,!0),e.font="25px Arial",e.fillText(t,n-7,o+10),e.stroke()}(u,e.value,e.x,e.y)}))}()}),[]);var d,u,j=!1,h=0,p=0,b=0,g=0,v="black",f=2;return a?Object(o.jsx)(I,{recorded:e.recorded}):Object(o.jsxs)("div",{style:{padding:"29px",margin:"0px",background:"rgba(0,0,0,0.2)"},children:[Object(o.jsx)("canvas",{id:"can",width:"1200",height:"1200"}),Object(o.jsx)("p",{style:{"text-align":"center"},children:"Dra ett streck fr\xe5n 1-A, sedan vidare fr\xe5n A till 2 sedan 2 till b och vidare."})]})},N=n(21),R=n(43),_=n.p+"static/media/moca_words.d3087c5f.m4a",B=n.p+"static/media/moca_words.ec94265b.mp3",H=["Stol","Pl\xe5nbok","T\xe5ng","Munspel","Sax"],F=function(){var e=Object(R.a)(_),t=(Object(l.a)(e,1)[0],Object(i.useState)("")),n=Object(l.a)(t,2),r=n[0],a=n[1];Object(i.useEffect)((function(){new Audio(B).play();var e=(new Date).getTime();console.log("the startime was "+e),a(e);var t=setInterval((function(){c()}),1e3);return function(){console.log("clearing interval"),clearInterval(t)}}),[]);var c=function(){var e=(new Date).getTime();console.log("we are checking time at",e),console.log("the start time was",r);var t=function(e,t){for(var n=Math.floor((t-e)/1e3),o=[{d:60,l:"seconds"},{d:60,l:"minutes"},{d:24,l:"hours"},{d:7,l:"days"}],i="",r=0;r<o.length;++r)i=n%o[r].d+" "+o[r].l+" "+i,n=Math.floor(n/o[r].d);return i}(r,e);console.log("the difference was",t)},s=function(){console.log("playing a sound")};return Object(o.jsxs)("div",{onClick:function(){return s},className:"Word-recall-header",children:[H.map((function(e,t){return Object(o.jsx)("p",{children:e},t)})),Object(o.jsx)("audio",Object(N.a)({controls:!0,src:B,type:"audio/mp3"},"controls","controls"))]})};function U(e){var t=r.a.useState(0),n=Object(l.a)(t,2),a=n[0],c=n[1],s=r.a.useState(!1),d=Object(l.a)(s,2),u=d[0],j=d[1];return console.log("the audio is",e.recorded),Object(i.useEffect)((function(){if(!u){var t=setInterval((function(){console.log("counter is",a),console.log("completed is",u),a>=e.phrases.length-1?(console.log("INSIDE COMPLETED"),j(!0),e.stopMicrophone(e.mediaRecorder)):c(a+1)}),5e3);return function(){return clearInterval(t)}}}),[a,u]),u?Object(o.jsx)(L,{recorded:e.recorded}):Object(o.jsxs)(i.Fragment,{children:[Object(o.jsx)("h3",{children:e.phrases&&e.phrases[a].header}),Object(o.jsxs)("p",{children:[" ",e.phrases[a].text]})]})}var J,K=[{header:"S\xe4g namnet p\xe5 s\xe5 m\xe5nga djur som du kan p\xe5 60 sekunder.",text:""},{header:"Kom ih\xe5g orden som visas upp",text:"Stol, Pl\xe5nbok T\xe5ng Munspel Sax"},{header:"S\xe4g de fem orden som visades upp ",text:""}];function W(){return Object(o.jsx)("div",{className:"Logo-header",children:Object(o.jsx)("img",{src:s,width:"100px",alt:"logo"})})}function G(){var e=r.a.useState(!0),t=Object(l.a)(e,2),n=t[0],i=t[1],a=r.a.useState(!1),c=Object(l.a)(a,2),s=c[0],d=c[1],u=r.a.useState(!1),j=Object(l.a)(u,2),h=(j[0],j[1],r.a.useState(!1)),b=Object(l.a)(h,2),g=b[0],v=(b[1],r.a.useState(0)),f=Object(l.a)(v,2),O=(f[0],f[1]),k=function(){console.log("toggling the microphone"),s?y():(console.log("we are getting the microphone"),w())},y=function(e){console.log("audio is",s),s.getTracks().forEach((function(e){return e.stop()})),console.log("STOPPING THE audio",s),e.stop(),d(s)},w=function(){var e=Object(m.a)(x.a.mark((function e(){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({audio:!0,video:!1});case 2:t=e.sent,console.log("the audio in get audio is",t),(J=new MediaRecorder(t)).start(),J.ondataavailable=function(e){console.log("the mediarecorder data is called with",e);var t=URL.createObjectURL(e.data),n=document.createElement("audio");n.controls=!0,n.src=t,document.body.appendChild(n),n.play()},d(t);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(o.jsxs)(r.a.Fragment,{children:[Object(o.jsx)("div",{className:"App",children:Object(o.jsxs)("header",{className:"App-header",children:[Object(o.jsx)(W,{}),!n&&g?Object(o.jsx)(F,{}):n?null:Object(o.jsx)(U,{mediaRecorder:J,readingTime:Object({NODE_ENV:"production",PUBLIC_URL:"/web-cognitive-test",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).READING_TIME,recorded:s,stopMicrophone:y,phrases:K})]})}),Object(o.jsx)(p,{open:n,handleClose:function(){return i(!1),O(new Date(Date.now())),void k()},handleOpen:function(){i(!0)}})]})}var V=function(){return Object(o.jsx)("div",{children:"This is the about page"})};function X(){return Object(o.jsx)(g.a,{children:Object(o.jsxs)(v.c,{children:[Object(o.jsx)(v.a,{path:"/about",children:Object(o.jsx)(V,{})}),Object(o.jsx)(v.a,{path:"/admin",children:Object(o.jsx)(k,{})}),Object(o.jsx)(v.a,{path:"/wordrecall",children:Object(o.jsx)(F,{})}),Object(o.jsx)(v.a,{path:"/trailmaking",children:Object(o.jsx)(L,{})}),Object(o.jsx)(v.a,{path:"/",children:Object(o.jsx)(G,{})})]})})}c.a.render(Object(o.jsx)(r.a.StrictMode,{children:Object(o.jsx)(X,{})}),document.getElementById("root"))}},[[61,1,2]]]);
//# sourceMappingURL=main.04044ef0.chunk.js.map